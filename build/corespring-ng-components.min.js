!function(){var version;version="0.0.2",angular.module("cs.services",[]),angular.module("cs.directives",["cs.services"]),angular.module("cs",["cs.directives"]).value("cs.config",{}),angular.module("cs.directives").directive("aceEditor",["$timeout","Utils",function(a,b){var c;return c={replace:!0,template:"<div/>",link:function(c,d,e){var f,g,h,i,j;return f=b.applyValue,g=function(b){var d,e,f,g;for(e=b.split(","),f=0,g=e.length;g>f;f++)d=e[f],c.$on(d,function(){return a(function(){return c.editor.resize(),null!=c.aceModel?c.editor.getSession().setValue(c.$eval(c.aceModel)):void 0})});return null},i=function(a,b){var d,e,f,g,h;if(null!=b)for(e=0,g=b.length;g>e;e++)d=b[e],c.editor.renderer.removeGutterDecoration(d.lineNumber-1,"ace_failed");if(null!=a)for(f=0,h=a.length;h>f;f++)d=a[f],c.editor.renderer.addGutterDecoration(d.lineNumber-1,"ace_failed");return null},null!=e.aceResizeEvents&&g(e.aceResizeEvents),null!=e.aceExceptions&&c.$watch(e.aceExceptions,i),c.editor=ace.edit(d[0]),c.editor.getSession().setUseWrapMode(!0),j=e.aceTheme||"eclipse",c.editor.setTheme("ace/theme/"+j),c.$watch(e.aceMode,function(a){var b,d;if(null!=a&&null!=c.editor&&("js"===a&&(a="javascript"),d=require("ace/mode/"+a),null!=d))return b=d.Mode,c.editor.getSession().setMode(new b),null}),c.aceModel=e.aceModel,c.$watch(c.aceModel,function(b){return c.changeFromEditor?void 0:(a(function(){return c.suppressChange=!0,c.editor.getSession().setValue(b),c.suppressChange=!1,null}),null)}),h=c.$eval(c.aceModel),c.editor.getSession().setValue(h),c.editor.getSession().on("change",function(){var a;if(!c.suppressChange)return c.changeFromEditor=!0,a=c.editor.getSession().getValue(),f(c,c.aceModel,a),c.changeFromEditor=!1,null})}}}]),angular.module("cs.directives").directive("confirmPopup",["$timeout","Utils",function(a,b){var c,d;return d=function(a,c,d){return c.addClass("modal hide"),c.find("#confirm").click(function(){return c.modal("hide"),null!=a[d.confirmed]&&a[d.confirmed](),null}),c.find("#cancel").click(function(){return a.$apply(function(){return b.applyValue(a,d.ngModel,a.stashedValue),null}),a.stashedValue=null,c.modal("hide"),null!=a[d.cancelled]&&a[d.cancelled](),null}),a.$watch(d.ngModel,function(b,d){return d===!0&&b===!1&&(a.stashedValue=d,c.modal({show:!0})),null==b&&null!=d?(a.stashedValue=d,c.modal({show:!0})):void 0}),c.on("shown",function(){return c.find("[autofocus]").focus()}),null},c={require:"ngModel",link:d}}]),angular.module("cs.directives").directive("contentEditable",function(){var a,b;return a=13,b={restrict:"A",require:"ngModel",scope:{ngModel:"=",contentId:"@",validateChange:"&"},link:function(b,c,d){var e;return c.attr("contenteditable",""),b.$watch("ngModel",function(){return c.html(b.ngModel),null}),b.onValidationResult=function(a){return a&&(b.ngModel=c.html()),null},e=function(a){return b.validateChange&&d.validateChange?b.validateChange({text:a,id:b.contentId,callback:b.onValidationResult}):b.onValidationResult(!0)},c.bind("keydown",function(b){var d;return b.which===a&&(d=c.html(),e(d),c.blur()),null}),c.bind("blur",function(){return c.html(b.ngModel),null})}}}),angular.module("cs.directives").directive("fileDrop",function(){var a;return a={link:function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o;return n=function(a){return a.attr("class").split(/\s+/)},g=a[c.onFileDropped],o=n(b),d=c.fileTypes.split(","),m=b[0],e=function(a){var b,c,e;for(c=0,e=d.length;e>c;c++)if(b=d[c],-1!==a.type.indexOf(b))return!0;return!1},h=function(a,c){return function(d){return console.log("drag enter leave"),b.attr("class",o.join(" ")),null!=a&&b.addClass(a),d.stopPropagation(),d.preventDefault(),null!=c&&c(d),null}},i=h(),j=h("over"),l=function(a){var b;return console.log("drop evt:",JSON.parse(JSON.stringify(a.dataTransfer))),b=a.dataTransfer.files,1===b.length&&e(b[0])&&(console.log(b),null!=g&&g(b[0])),null},k=h("",l),f=function(a,b,c,d){return a.addEventListener?a.addEventListener(b,c,d):a.attachEvent&&a.attachEvent(b,c,d),null},f(m,"dragleave",i,!1),f(m,"dragover",j,!1),f(m,"drop",k,!1)}}}),XMLHttpRequest.prototype.sendAsBinary||(XMLHttpRequest.prototype.sendAsBinary=function(a){var b,c,d;return b=function(a){return 255&a.charCodeAt(0)},c=Array.prototype.map.call(a,b),d=new Uint8Array(c),this.send(d.buffer),null}),window.com||(window.com={}),com.ee||(com.ee={}),this.com.ee.XHRWrapper=function(){function a(a,b,c,d,e){var f,g=this;this.file=a,this.formBody=b,this.url=c,this.name=d,this.options=e,b=this.binaryData,f=(new Date).getTime(),this.request=new XMLHttpRequest,this.request.upload.index=0,this.request.upload.file=this.file,this.request.upload.downloadStartTime=f,this.request.upload.currentStart=f,this.request.upload.currentProgress=0,this.request.upload.startData=0,this.request.open("POST",this.url,!0),this.request.setRequestHeader("Accept","application/json"),null!=this.options.onLoadStart&&this.options.onLoadStart(),this.request.onload=function(){return null!=g.options.onUploadComplete?g.options.onUploadComplete(g.request.responseText,g.request.status):void 0}}return a.prototype.setRequestHeader=function(a,b){return this.request.setRequestHeader(a,b),null},a.prototype.beginUpload=function(){return this.request.sendAsBinary(this.formBody),null},a}(),this.com.ee.RawFileUploader=function(){function a(a,b,c,d,e){this.file=a,this.binaryData=b,this.url=c,this.name=d,this.options=e,this.xhr=new com.ee.XHRWrapper(this.file,this.binaryData,this.url,this.name,this.options),this.xhr.setRequestHeader("Accept","application/json")}return a.prototype.beginUpload=function(){return this.xhr.beginUpload()},a}(),this.com.ee.MultipartFileUploader=function(){function a(a,b,c,d,e){var f,g,h;this.file=a,this.binaryData=b,this.url=c,this.name=d,this.options=e,h=Math.floor(1e5*Math.random()),f="------multipartformboundary"+h,g=this._buildMultipartFormBody(this.file,this.binaryData,f),this.xhr=new com.ee.XHRWrapper(this.file,g,this.url,this.name,this.options),this.xhr.setRequestHeader("content-type","multipart/form-data; boundary="+f),this.xhr.setRequestHeader("Accept","application/json")}return a.prototype.beginUpload=function(){return this.xhr.beginUpload()},a.prototype._buildMultipartFormBody=function(a,b,c){var d,e,f;return e=new com.ee.MultipartFormBuilder(c),f=this.options.additionalData,d=[{file:a,data:b,paramName:this.name}],e.buildMultipartFormBody(f,d,c)},a}(),window.com||(window.com={}),com.ee||(com.ee={}),this.com.ee.MultipartFormBuilder=function(){function a(a){this.boundary=a,this.dashdash="--",this.crlf="\r\n"}return a.prototype.buildMultipartFormBody=function(a,b){var c,d=this;return c="",null!=a&&$.each(a,function(a,b){return"function"==typeof b&&(b=b()),c+=d.buildFormSegment(a,b)}),null!=b&&$.each(b,function(a,b){return c+=d.buildFileFormSegment(b.paramName,b.file,b.data),null}),c+=this.dashdash,c+=this.boundary,c+=this.dashdash,c+=this.crlf},a.prototype.buildFormSegment=function(a,b){var c;return c=this._buildContentDisposition(a),this._buildFormSegment(c,b)},a.prototype._buildContentDisposition=function(a){var b;return b='Content-Disposition: form-data; name="${name}" ',b.replace("${name}",a)},a.prototype._buildFileContentDisposition=function(a,b){var c;return this.template='Content-Disposition: form-data; name="${formName}"; filename="${fileName}" ',c=this.template.replace("${formName}",a),c=c.replace("${fileName}",b)},a.prototype.buildFileFormSegment=function(a,b,c){var d;return d=this._buildFileContentDisposition(a,b.name),d+=this.crlf,d+="Content-Type: "+b.type,this._buildFormSegment(d,c)},a.prototype._buildFormSegment=function(a,b){var c;return c="",c+=this.dashdash,c+=this.boundary,c+=this.crlf,c+=a,c+=this.crlf,c+=this.crlf,c+=b,c+=this.crlf},a}(),angular.module("cs.directives").directive("fileUploader",function(a){var b;return b={replace:!1,link:function(b,c,d){var e,f,g,h,i,j,k,l,m;return k="multipart","raw"===d.fuMode&&(k="raw"),j=parseInt(d.fuMaxSize)||200,i=1024*j,g="file_upload_input_"+Math.round(1e4*Math.random()),e=null,m=function(){return e.trigger("click")},f=function(){var a;return a="position: absolute; left: 0px; top: 0px; width: 0px; height: 0px; visibility: hidden; padding: 0px; margin: 0px; line-height: 0px;",b.fileInput='<input \n       type="file" \n       id="'+g+'"\n       style="'+a+'" \n       name="'+d.fuName+'">\n</input>',$(c).parent().append(b.fileInput),e=$(c).parent().find("#"+g),e.change(function(a){return h(a)}),null},h=function(a){var b,c,d;return c=a.target.files,b=a.target.files[0],d=new FileReader,d.onloadend=function(a){return l(b,a)},d.readAsBinaryString(b),null},l=function(c,e){var f,g,h,l,m;return c.size>i?(null!=b[d.fuFileSizeGreaterThanMax]&&b[d.fuFileSizeGreaterThanMax](c,j),a.$broadcast("fileSizeGreaterThanMax",c,j),void 0):(m=d.fuUrl,-1!==d.fuUrl.indexOf("()")&&(f=d.fuUrl.replace("(","").replace(")",""),"function"==typeof b[f]&&(m=b[f](c))),g=d.fuName,h={onLoadStart:function(){return a.$broadcast("uploadStarted")},onUploadComplete:function(c,e){return null!=b[d.fuUploadCompleted]&&b[d.fuUploadCompleted](c,e),a.$broadcast("uploadCompleted",c,e)}},l="raw"===k?new com.ee.RawFileUploader(c,e.target.result,m,g,h):new com.ee.MultipartFileUploader(c,e.target.result,m,g,h),l.beginUpload(),null)},f(),c.bind("click",m),null}}}),angular.module("cs.services").factory("Canvas",function(){var a;return a=function(){function a(a){this.board=a,this.points=[]}return a.prototype.getMouseCoords=function(a){return new JXG.Coords(JXG.COORDS_BY_SCREEN,[a.offsetX,a.offsetY],this.board)},a.prototype.pointCollision=function(a){var b,c,d,e;for(e=this.board.objects,c=0,d=e.length;d>c;c++)return b=e[c],JXG.isPoint(this.board.objects[b])&&this.board.objects[b].hasPoint(a.scrCoords[1],a.scrCoords[2])?b:null},a.prototype.addPoint=function(a){var b;return b=this.board.create("point",[a.usrCoords[1],a.usrCoords[2]]),this.points.push(b),b},a.prototype.popPoint=function(){return this.board.removeObject(this.points.pop)},a.prototype.removePoint=function(a){var b,c,d,e,f;for(this.board.removeObject(a),e=this.points,f=[],c=0,d=e.length;d>c;c++)b=e[c],b.id!==a&&f.push(this.points=b);return f},a.prototype.on=function(a,b){return this.board.on(a,b)},a.prototype.makeLine=function(){return 2===this.points.length?this.board.create("line",[this.points[0],this.points[1]],{strokeColor:"#00ff00",strokeWidth:2,fixed:!0}):void 0},a.prototype.prettifyPoints=function(){var a,b,c,d,e;for(d=this.points,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push({name:a.name,x:a.coords.usrCoords[1],y:a.coords.usrCoords[2]});return e},a.prototype.interpolatePoint=function(a,b){var c;return c=function(a){return Math.round(a/b)*b},a.moveTo([c(a.X()),c(a.Y())])},a}()}),angular.module("cs.directives").directive("jsxGraph",function(a){return{template:"<div id='box' class='jxgbox' style='width:200px; height:200px;'></div>",restrict:"A",scope:{boardParams:"=",pointsCallback:"=",maxPoints:"@",mousePtr:"=",scale:"@"},link:function(b){var c,d,e;return d=b.boardParams.domain,e=b.boardParams.range,d&&e?(c=new a(JXG.JSXGraph.initBoard("box",{boundingbox:[0-d,e,d,0-e],grid:!0,axis:!0,showNavigation:!1,showCopyright:!1})),c.on("up",function(a){var d,e,f,g;d=c.getMouseCoords(a),g=c.pointCollision(d),null==g&&c.points.length<b.maxPoints&&(f=c.addPoint(d),f.on("up",function(){c.interpolatePoint(f,b.scale),b.pointsCallback(c.prettifyPoints())}),c.interpolatePoint(f,b.scale),b.pointsCallback(c.prettifyPoints()),2===c.points.length&&(e=c.makeLine()))}),c.on("move",function(a){var d;d=c.getMouseCoords(a),b.mousePtr={x:d.usrCoords[1],y:d.usrCoords[2]}})):console.error("domain and/or range unspecified")}}}),angular.module("cs.directives").directive("loadingButton",[function(){var a;return a={require:"ngModel",link:function(a,b,c){return a.$watch(c.ngModel,function(a){var c;return c=a?"loading":"reset",$(b).button(c)})}}}]),angular.module("cs.directives").directive("multiSelect",["$timeout","Utils",function(a,b){var c,d,e,f,g;return d='<ul>\n  <li ng-repeat="o in options" >\n    <input type="checkbox" ng-model="selectedArr[o.${uidKey}]" ng-click="toggleItem(o)"></input>\n    {{multiGetTitle(o)}}\n  </li>\n</ul>',g='<span class="multi-select">\n ${summaryHtml}\n  <div class="chooser" ng-show="showChooser">\n   ${repeater}\n  </div>\n</span>',f=function(a,c,d){var e,f,g,h,i,j;return h=d.multiOptions,i=d.multiUid||"key",g=d.multiModel,f=d.multiGetTitle,e=d.multiChange,a.noneSelected="None selected",a.showChooser=!1,a.$watch(h,function(b){return a.options=b,j(),null}),a.$watch(g,function(b){return a.selected=null!=b?b:[],j(),null}),j=function(){var b,c,d,e;if(null==a.selected)return null;for(a.selectedArr={},e=a.selected,c=0,d=e.length;d>c;c++)b=e[c],b[i]&&(a.selectedArr[b[i]]=!0);return null},a.toggleItem=function(c){var d,f,j,k,l;return f=function(a,b){var c,d,e,f;for(d=e=0,f=a.length;f>e;d=++e)if(c=a[d],c[i]&&c[i]===b[i])return d;return-1},null==a.$eval(g)&&b.applyValue(a,g,[]),d=a.$eval(g),j=f(d,c),k=a.$eval(h).indexOf(c),-1===j?d.push(c):d.splice(j,1),l=function(b,c){var d,e;return d=a.$eval(h).indexOf(b),e=a.$eval(h).indexOf(c),d-e},b.applyValue(a,g,d.sort(l)),null!=e&&a[e](),null},a.multiGetTitle=function(b){return a[f](b)},null},c=function(a,b){var c,e,h,i,j;if(j=b.multiUid||"key",c=null,a.find(".summary").each(function(){return c=$(this).clone().wrap("<p>").parent().html()}),i=c,h=null,a.find(".repeater").each(function(){return h=$(this).clone().wrap("<p>").parent().html()}),null==h&&(h=d),null==i)throw"You need to add a summary node to the multi-select: eg: <div id='summary'>...</div>";return i=i.replace(/(<.*?)(>)/,"$1 ng-click='showChooser=!showChooser' $2"),e=g.replace("${repeater}",h).replace("${uidKey}",j).replace("${summaryHtml}",i),a.html(e),f},e={restrict:"A",compile:c,scope:"isolate"}}]),jQuery.expr[":"].matches_ci||(jQuery.expr[":"].matches_ci=function(a,b,c){return jQuery(a).text().toUpperCase()===c[3].toUpperCase()}),angular.module("cs.directives").directive("tagList",function(){var a;return a={replace:!1,template:"<span/>",link:function(a,b,c){var d,e,f,g,h,i;return i=null,e=null,g=c.tagListLinkClass||"tag-list-link",f=function(){var a,c,d,f;for(d=0,f=e.length;f>d;d++)c=e[d],a=$("<a class='"+g+"' href='javascript:void(0)'>"+c+"</a>"),$(b).append(a),a.click(function(a){return h(a)});return null},d=function(){var a,c,d,e;for($(b).find("."+g).removeClass("selected"),d=0,e=i.length;e>d;d++)c=i[d],a=$(b).find("a:matches_ci('"+c+"')"),a.addClass("selected");return null},h=function(b){var e,f;return f=$(b.target).text(),e=$(b.target).hasClass("selected"),a.$apply(function(){var b,d;return d=a.$eval(c.selectedTags),e?(b=d.indexOf(f),d.splice(b,1)):-1===d.indexOf(f)?d.push(f):void 0}),d(),null},a.$watch(c.selectedTags,function(a){return i=a,null!=e&&null!=i&&d(),null}),a.$watch(c.tags,function(a){return e=a,null!=e&&f(),null!=i&&d(),null}),null}}}),angular.module("cs.directives").directive("whenScrolled",function(){var a;return a=function(a,b,c){var d,e,f,g;return g=b[0],e=function(){var d,e,f;return d=g.getBoundingClientRect(),0!==d.height?(e=b.scrollTop(),f=b.scrollTop()+b.innerHeight(),f>=g.scrollHeight&&a.$apply(c.whenScrolled),null):void 0},f=function(){var b;return b=g.getBoundingClientRect(),0!==b.height?(b.bottom<=window.innerHeight&&a.$apply(c.whenScrolled),null):void 0},d=c.scrolledMode||"window","window"===d?angular.element(window).bind("scroll",f):b.bind("scroll",e),null}}),angular.module("cs.services").factory("Utils",function(){var a;return a={applyValue:function(a,b,c){var d,e,f;if(d=arguments.callee,null==a)throw"Cannot apply to null object the property:  "+b+" with value: "+c;return-1===b.indexOf(".")?a[b]=c:(f=b.split("."),e=f.shift(),d(a[e],f.join("."),c)),null}}})}.call(this);